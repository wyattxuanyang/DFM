# DFM: Differentiable Feature Matching for Anomaly Detection
Methods that rely on feature matching offer a clear and precise framework for unsupervised anomaly detection and have shown impressive performance. To improve adaptation for downstream tasks, contemporary variation methods mostly rely on intuitive self-supervised adapter training techniques and manually crafted matching algorithms. However, existing variants often optimize the feature extraction module and the feature matching module separately, causing a lack of compatibility between the feature extractor and the matching algorithm, resulting in suboptimal results. In order to tackle these problems, we suggest the implementation of a trainable and Differentiable Feature Matching (DFM) framework that can be optimized jointly with the feature extractor. DFM transforms the nearest neighbor matching into a pooling-based module and embeds it into a Feature Matching Network (FMN). This design integrates the feature extraction module and the feature matching module into an end-to-end model. DFM offers a general framework that can be integrated into any method that relies on feature matching. We implemented DFM with various backbones and conducted extensive experiments on a wide range of tasks and datasets, demonstrating the effectiveness of DFM. Notably, we achieve state-of-the-art results in the recently proposed continual anomaly detection problem, with instance AUROC up to 94.9% and pixel AP up to 47.9%.
Visualization of anomaly segmentation results on the MVTecAD dataset is shown in the output_image_new.pdf. Both PatchCore and our method utilize ViT-L as the backbone. As shown in the results, our method demonstrates a strong capability for accurate localization and generates segmentation maps with less noise compared to PatchCore
